<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spaanse Woordenschat Trainer</title>
    <style>
        /* ... (dezelfde CSS als vorige versie) ... */
        .settings-panel {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 4px;
        }
        .settings-panel input {
            width: 100%;
            margin-bottom: 10px;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="card">
        <div id="setup" class="settings-panel">
            <h2>GitHub Instellingen</h2>
            <input type="text" id="repoOwner" placeholder="GitHub gebruikersnaam">
            <input type="text" id="repoName" placeholder="Repository naam">
            <input type="password" id="githubToken" placeholder="GitHub Personal Access Token">
            <button id="saveSettings">Instellingen opslaan</button>
        </div>

        <!-- Rest van de HTML blijft hetzelfde als de vorige versie -->
        
    </div>

    <script>
        // GitHub configuratie
        let githubConfig = {
            owner: '',
            repo: '',
            token: ''
        };

        // Laad configuratie bij opstarten
        const loadConfig = () => {
            const config = localStorage.getItem('githubConfig');
            if (config) {
                githubConfig = JSON.parse(config);
                document.getElementById('setup').classList.add('hidden');
                syncWithGitHub(); // Laad woorden van GitHub
            }
        };

        // Sla GitHub configuratie op
        document.getElementById('saveSettings').addEventListener('click', () => {
            githubConfig = {
                owner: document.getElementById('repoOwner').value,
                repo: document.getElementById('repoName').value,
                token: document.getElementById('githubToken').value
            };
            localStorage.setItem('githubConfig', JSON.stringify(githubConfig));
            document.getElementById('setup').classList.add('hidden');
            syncWithGitHub();
        });

        // GitHub API functies
        async function getWordsFromGitHub() {
            try {
                const response = await fetch(`https://api.github.com/repos/${githubConfig.owner}/${githubConfig.repo}/contents/words.json`, {
                    headers: {
                        'Authorization': `token ${githubConfig.token}`,
                        'Accept': 'application/vnd.github.v3.raw'
                    }
                });
                
                if (response.status === 404) {
                    // Bestand bestaat nog niet, maak het aan
                    return [];
                }
                
                const data = await response.json();
                return Array.isArray(data) ? data : [];
            } catch (error) {
                console.error('Fout bij ophalen woorden:', error);
                return [];
            }
        }

        async function saveWordsToGitHub(words) {
            try {
                // Haal eerst de huidige file sha op als die bestaat
                let sha = '';
                try {
                    const fileInfo = await fetch(`https://api.github.com/repos/${githubConfig.owner}/${githubConfig.repo}/contents/words.json`, {
                        headers: {
                            'Authorization': `token ${githubConfig.token}`
                        }
                    });
                    if (fileInfo.ok) {
                        const data = await fileInfo.json();
                        sha = data.sha;
                    }
                } catch (e) {
                    // Bestand bestaat nog niet, geen sha nodig
                }

                // Update of maak het bestand
                const response = await fetch(`https://api.github.com/repos/${githubConfig.owner}/${githubConfig.repo}/contents/words.json`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `token ${githubConfig.token}`,
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: 'Update woorden',
                        content: btoa(JSON.stringify(words, null, 2)),
                        sha: sha || undefined
                    })
                });

                if (!response.ok) {
                    throw new Error('Fout bij opslaan van woorden');
                }
            } catch (error) {
                console.error('Fout bij opslaan naar GitHub:', error);
                alert('Er ging iets mis bij het opslaan. Controleer uw GitHub instellingen.');
            }
        }

        // Synchronisatie functie
        async function syncWithGitHub() {
            const words = await getWordsFromGitHub();
            localStorage.setItem('spanishWords', JSON.stringify(words));
            updateStatistics();
        }

        // Aangepaste saveWord functie
        const saveWord = async (dutch, spanish) => {
            const words = JSON.parse(localStorage.getItem('spanishWords') || '[]');
            words.push({
                dutch,
                spanish,
                date: new Date().toISOString().split('T')[0]
            });
            localStorage.setItem('spanishWords', JSON.stringify(words));
            await saveWordsToGitHub(words);
            updateStatistics();
        };

        // Rest van de JavaScript code blijft hetzelfde als de vorige versie...

        // Initialize
        loadConfig();
    </script>
</body>
</html>
