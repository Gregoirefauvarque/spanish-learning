<!DOCTYPE html>
<html>
<head>
    <title>Spaanse Woordenschat</title>
    <meta charset="UTF-8">
    <style>
        /* ... (vorige styles behouden) ... */
        .error-message {
            color: red;
            margin-top: 10px;
            padding: 10px;
            background-color: #ffebee;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Spaanse Woordenschat Trainer</h1>
        
        <div id="settings">
            <h2>GitHub Instellingen</h2>
            <input type="text" id="username" placeholder="GitHub gebruikersnaam">
            <input type="text" id="repo" placeholder="Repository naam">
            <input type="password" id="token" placeholder="GitHub token">
            <button onclick="saveSettings()">Opslaan</button>
            <div id="errorMessage" class="error-message hidden"></div>
        </div>

        <!-- ... (rest van de HTML blijft hetzelfde) ... -->
    </div>

    <script>
        async function testGitHubConnection(username, repo, token) {
            try {
                const response = await fetch(`https://api.github.com/repos/${username}/${repo}`, {
                    headers: {
                        'Authorization': `token ${token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`GitHub API fout: ${response.status}`);
                }
                
                return true;
            } catch (error) {
                console.error('Connectie test fout:', error);
                return false;
            }
        }

        async function saveSettings() {
            const username = document.getElementById('username').value.trim();
            const repo = document.getElementById('repo').value.trim();
            const token = document.getElementById('token').value.trim();
            const errorDiv = document.getElementById('errorMessage');
            
            if (!username || !repo || !token) {
                showError('Vul alle velden in.');
                return;
            }

            showError('Verbinding testen...');
            
            try {
                const isConnected = await testGitHubConnection(username, repo, token);
                
                if (!isConnected) {
                    showError('Kan geen verbinding maken met GitHub. Controleer uw instellingen.');
                    return;
                }

                // Sla configuratie op
                githubConfig = { username, repo, token };
                localStorage.setItem('githubConfig', JSON.stringify(githubConfig));
                
                // Test words.json aanmaken/laden
                try {
                    allWords = await loadFromGitHub();
                    updateStats();
                    document.getElementById('settings').classList.add('hidden');
                    document.getElementById('wordInput').classList.remove('hidden');
                    errorDiv.classList.add('hidden');
                } catch (error) {
                    console.error('Fout bij laden woorden:', error);
                    showError('Fout bij laden van woorden. ' + error.message);
                }
            } catch (error) {
                console.error('Algemene fout:', error);
                showError('Er is een fout opgetreden: ' + error.message);
            }
        }

        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.classList.remove('hidden');
        }

        // ... (rest van de JavaScript functionaliteit) ...
    </script>
</body>
</html>
